(function(e){function t(t){for(var r,a,c=t[0],l=t[1],s=t[2],d=0,f=[];d<c.length;d++)a=c[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(f.length)f.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==i[l]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),i=n.n(r);i.a},1:function(e,t){},2:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"title"},[e._v("Image to Spreadsheet Converter")]),n("div",{staticClass:"col"},[n("div",{attrs:{id:"file-input-container"}},[n("input",{attrs:{id:"file",type:"file",accept:"image/*"},on:{change:function(t){return e.onFileChange(t)}}}),n("label",{staticClass:"file-label button",attrs:{for:"file"}},[n("svg",{staticClass:"bi bi-file-earmark-image",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",id:"file-icon",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"fill-rule":"evenodd",d:"M12 16a2 2 0 0 0 2-2V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8zM3 2a1 1 0 0 1 1-1h5.5v2A1.5 1.5 0 0 0 11 4.5h2V10l-2.083-2.083a.5.5 0 0 0-.76.063L8 11 5.835 9.7a.5.5 0 0 0-.611.076L3 12V2z"}}),n("path",{attrs:{"fill-rule":"evenodd",d:"M6.502 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}})]),e._v(" "+e._s(e.fileText)+" ")]),"Feed me images..."!==e.fileText?n("div",{staticClass:"button convert",on:{click:function(t){return e.onFileUpload()}}},[e._v(" Convert! "),e.converting?n("div",{staticClass:"loader"}):e._e()]):e._e()]),n("div",{staticClass:"button subpixel-sw",on:{click:function(t){return e.subPixelSwitch()}}},[n("span",{staticClass:"material-icons"},[e._v(e._s(e.checked?"check_box":"check_box_outline_blank"))]),e._v(" Include Subpixels ")])]),e._m(0)])},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"credit"},[e._v(" Made by "),n("a",{attrs:{href:"https://joshlucpoll.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Joshlucpoll")])])}],a=(n("cb29"),n("a15b"),n("fb6a"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("1276"),n("4c53"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),c=n("ef21"),l=n.n(c),s=n("e8ae"),u=n.n(s),d={name:"App",data:function(){return{fileText:"Feed me images...",converting:!1,workbookURL:{whole:!1,sub:!1},checked:!1}},methods:{toColumnName:function(e){for(var t="",n=1,r=26;(e-=n)>=0;n=r,r*=26)t=String.fromCharCode(parseInt(e%r/n)+65)+t;return t},onFileChange:function(e){this.file=e.target.files[0],this.fileText=this.file.name,this.fileName=this.file.name.split(".").slice(0,-1).join("."),this.workbookURL={whole:!1,sub:!1},this.file&&this.displayPreview()},subPixelSwitch:function(){this.checked=!this.checked},downloadFile:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=document.createElement("a"),r.setAttribute("href",e),r.setAttribute("download","".concat(t.fileName,"-to-spreadsheet.xlsx")),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r);case 7:case"end":return n.stop()}}),n)})))()},sleep:function(e){return new Promise((function(t){return setTimeout(t,e)}))},convert:function(){var e=this,t=new FileReader;t.onload=function(t){e.converting=!0,l.a.read(t.target.result).then(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(n){var r,i,o,a,c,l,s,d,f,h,p,b,m,v,w,g,k,y,x;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.scaleToFit(400,e.checked?200:600),r=[],n.scan(0,0,n.bitmap.width,n.bitmap.height,(function(e,t,n){var i=this.bitmap.data[n+0],o=this.bitmap.data[n+1],a=this.bitmap.data[n+2];r.push([i,o,a])})),i=new u.a.Workbook,o=i.addWorksheet("Image",{properties:{defaultColWidth:e.checked?10:3}}),a=function(e){var t=e.toString(16);return 1==t.length?"0"+t:t},c=0,!e.checked){t.next=11;break}for(l=0;l<n.bitmap.height;l++)for(s=0;s<n.bitmap.width;s++){for(d=0;d<3;d++)f=e.toColumnName(s+1)+(3*(l+1)-2+d),h=o.getCell(f),p="00",0==d&&(p+=a(r[c][0])+"0000"),1==d&&(p+="00"+a(r[c][1])+"00"),2==d&&(p+="0000"+a(r[c][2])),h.fill={type:"pattern",pattern:"solid",fgColor:{argb:p}};c++}t.next=19;break;case 11:b=0;case 12:if(!(b<n.bitmap.height)){t.next=19;break}for(m=0;m<n.bitmap.width;m++)v=e.toColumnName(m+1)+(b+1).toString(),w=o.getCell(v),g="00"+a(r[c][0])+a(r[c][1])+a(r[c][2]),w.fill={type:"pattern",pattern:"solid",fgColor:{argb:g}},c++;return t.next=16,e.sleep(1);case 16:b++,t.next=12;break;case 19:return t.next=21,i.xlsx.writeBuffer();case 21:k=t.sent,y=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),x=window.URL.createObjectURL(y),e.checked?e.workbookURL.sub=x:e.workbookURL.whole=x,e.converting=!1,e.downloadFile(x);case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){throw Error(e)}))},t.readAsArrayBuffer(this.file)},onFileUpload:function(){!this.checked&&this.workbookURL.whole?this.downloadFile(this.workbookURL.whole):this.checked&&this.workbookURL.sub?this.downloadFile(this.workbookURL.sub):this.convert()},displayPreview:function(){var e=new FileReader;e.onload=function(e){var t=document.body.contains(document.getElementById("preview"))?document.getElementById("preview"):document.createElement("img");t.id="preview",t.setAttribute("src",e.target.result),document.getElementById("file-input-container").before(t)},e.readAsDataURL(this.file)}}},f=d,h=(n("034f"),n("2877")),p=Object(h["a"])(f,i,o,!1,null,null,null),b=p.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(b)}}).$mount("#app")},"85ec":function(e,t,n){}});
//# sourceMappingURL=app.0d051510.js.map